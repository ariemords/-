<!DOCTYPE html>
<html lang="he">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>המתרימים שתורמים</title>
<style>
body{
    font-family: Arial;
    margin:0;
    background:#f4f4f4;
    text-align:center;
}
header{
    background:#2c3e50;
    color:white;
    padding:20px;
}
section{
    margin:20px;
}
input,textarea,button{
    display:block;
    margin:10px auto;
    padding:8px;
    width:90%;
    max-width:400px;
}
button{
    background:#2980b9;
    color:white;
    border:none;
    cursor:pointer;
}
button:hover{
    background:#1f6691;
}
.card{
    background:white;
    padding:15px;
    margin:10px auto;
    width:90%;
    max-width:400px;
    border-radius:8px;
    text-align:right;
}
img{
    max-width:100%;
    border-radius:5px;
}
</style>
</head>
<body>

<!-- מסך הבית -->
<div id="homeScreen">
    <header>
        <h1>המתרימים שתורמים</h1>
        <p>ספריית חפצים קהילתית</p>
        <p>שעות פעילות: א-ה 08:00-15:00</p>
    </header>

    <section>
        <h2>הרשמה</h2>
        <input id="registerName" placeholder="שם משתמש">
        <button onclick="register()">הרשמה</button>
    </section>

    <section>
        <h2>התחברות</h2>
        <input id="loginName" placeholder="שם משתמש">
        <button onclick="login()">התחברות</button>
    </section>
</div>

<!-- מסך פנימי -->
<div id="appScreen" style="display:none;">
    <section>
        <h2>הוספת חפץ</h2>
        <input id="itemName" placeholder="שם חפץ">
        <input type="file" id="itemImage">
        <button onclick="addItem()">הוסף חפץ</button>
    </section>

    <section>
        <h2>חפצים קיימים</h2>
        <button onclick="showItems()">הצג את כל החפצים</button>
        <div id="itemsContainer"></div>
    </section>
</div>

<section>
  <h2>השאל חפץ</h2>
  <input id="itemName" placeholder="שם חפץ">
  <input type="datetime-local" id="borrowDate">
  <button onclick="addItem()">השאל</button>
</section>
    
<script>
let currentUser = null;
let items = [];

// הרשמה פשוטה
function register(){
    const username = document.getElementById("registerName").value.trim();
    if(!username) return alert("אנא הזן שם משתמש");
    alert(`נרשמת בהצלחה כ-${username}`);
}

// התחברות
function login(){
    const username = document.getElementById("loginName").value.trim() || "אורח";
    currentUser = { email: username };
    alert(`התחברת בהצלחה כ-${username}`);
    
const name=document.getElementById("itemName").value;
    const date=document.getElementById("borrowDate").value;
    
    const d=new Date(date);
    const day=d.getDay();
const hour=d.getHours();
    if(day===5||day===6){ alert("אין השאלה בשישי או שבת"); return; }
    if(day===5||day===6){ alert("אין השאלה בשישי או שבת"); return; }

    await addDoc(collection(db,"items"),{ name:name, date:date, user:currentUser.email 
                                        }); alert("נשמר!"); loadItems(); }
    
    // הסתרת מסך הבית והצגת מסך פנימי
    document.getElementById("homeScreen").style.display = "none";
    document.getElementById("appScreen").style.display = "block";
}

// הוספת חפץ כולל תמונה
function addItem(){
    if(!currentUser) return alert("אנא התחבר כדי להוסיף חפץ");

    const name = document.getElementById("itemName").value.trim();
    const fileInput = document.getElementById("itemImage");
    const file = fileInput.files[0];

    if(!name) return alert("אנא הזן שם חפץ");

    let imageUrl = "";
    if(file){
        imageUrl = URL.createObjectURL(file);
    }
    
    items.push({
        name: name,
        user: currentUser.email,
        image: imageUrl
    });

    alert("חפץ נוסף בהצלחה!");
    fileInput.value = "";
    document.getElementById("itemName").value = "";
    loadItems();
}

// הצגת חפצים
function loadItems(){
    const container = document.getElementById("itemsContainer");
    if(!currentUser){
        container.innerHTML = "<p>אנא התחבר כדי לראות את החפצים</p>";
        return;
    }
const name=document.getElementById("itemName").value; const date=document.getElementById("borrowDate").value; const d=new Date(date); const day=d.getDay(); const hour=d.getHours(); if(day===5||day===6){ alert("אין השאלה בשישי או שבת"); return; } if(hour<8||hour>=15){ alert("רק בין 08:00 ל15:00"); return; } await addDoc(collection(db,"items"),{ name:name, date:date, user:currentUser.email }); alert("נשמר!"); loadItems(); }
    if(items.length === 0){
        container.innerHTML = "<p>אין חפצים להצגה</p>";
        return;
    }

    let html = "";
    items.forEach(item => {
        html += `<div class="card">
                    <h3>${item.name}</h3>
                    <p>מעלה על ידי: ${item.user}</p>`;
        if(item.image) html += `<img src="${item.image}">`;
        html += `</div>`;
    });

    container.innerHTML = html;
}

// כפתור הצג חפצים
function showItems(){
    if(!currentUser) return alert("אנא התחבר כדי לראות את החפצים");
    loadItems();
}
</script>

</body>
</html>


